---
$schema: "http://json-schema.org/draft-04/schema"
title: Index schema
type: object
definitions:
  dateTime:
    type: string
    pattern: ^\d{4}\-\d{2}\-\d{2}(\s\d{2}\:\d{2})?$
  configFormat:
    type: string
    pattern: \.(json|yaml|yml)$
  statusEnum:
    type: string
    enum:
      - ready
      - unlisted
      - enrollment
      - enrollment_ext
      - hidden
      - maintenance
      - nototal


required:
  - categories
  - end
  - language
  - modules
  - name
  - start
  - static_dir

additionalProperties: false
properties:
  categories:
    type: object
    description: Categories can be added freely
    additionalProperties:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        status:
          $ref: '#/definitions/statusEnum'
  end:
    $ref: '#/definitions/dateTime'
  language:
    type: string
    enum:
      - en
      - fi
  modules:
    type: array
    additionalItems: false
    items:
      type: object
      required:
        - children
        - key
        # muita pakollisia?
      properties:
        children:
          type: array
          additionalItems: false
          items:
            type: object
            required:
              - category
              - key
            #additionalProperties: false
            properties:
              category:
                type: string
              children:
                type: array
                additionalItems: false
                items:
                  type: object
                  required:
                    - category
                  properties:
                    category:
                      type: string
                    children:
                      type: array
                      additionalItems: false
                      items:
                        type: object
                        required:
                          - category
                          - key
                        #additionalProperties: false
                        properties:
                          allow_assistant_grading:
                            type: boolean
                          category:
                            type: string
                          config:
                            $ref: '#/definitions/configFormat'
                          confirm_the_level:
                            type: boolean
                          difficulty:
                            type: string
                          key:
                            type: string
                          lti:
                            type: string
                          lti_context_id:
                            type: string
                          lti_resource_link_id:
                            type: string
                          max_group_size:
                            type: number
                            minimum: 0
                          max_points:
                            type: number
                            minimum: 0
                          max_submissions:
                            type: number
                            minimum: 0
                          min_group_size:
                            type: number
                            minimum: 0
                          points_to_pass:
                            type: number
                            minimum: 0
                          scale_points:
                            type: number
                          status:
                            $ref: '#/definitions/statusEnum'
                          title:
                            type: string
                    key:
                      type: string
                    name:
                      type: string
                    static_content:
                      type: string
                    use_wide_column:
                      type: boolean

              key:
                type: string
              name:
                type: string
              static_content:
                type: string
              status:
                $ref: '#/definitions/statusEnum'
              use_wide_column:
                type: boolean
        close:
          $ref: '#/definitions/dateTime'
        key:
          type: string
        late_close:
          $ref: '#/definitions/dateTime'
        late_penalty:
          type: number
          minimum: 0.0
        name:
          type: string
        open:
          $ref: '#/definitions/dateTime'
        status:
          $ref: '#/definitions/statusEnum'

  name:
    type: string
  start:
    $ref: '#/definitions/dateTime'
  static_dir:
    type: string
